

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Confidence intervals: What they are (not) - Mark Girard</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Mark Girard">
<meta property="og:title" content="Confidence intervals: What they are (not)">


  <link rel="canonical" href="http://localhost:4000/posts/2021/12/Confidence-intervals/">
  <meta property="og:url" content="http://localhost:4000/posts/2021/12/Confidence-intervals/">



  <meta property="og:description" content="Recently at my work, I was asked to assist in determining the correct formula for determining a confidence interval of an unknown quantity from a bunch of random samples. In particular, given random samples drawn from two different normal distributions, the task was to determine the confidence interval for the ratio of the means of those two distributions. My coworker (whose job it was to present this information) had found a formula somewhere online by googling, but wasn’t sure it was correct and asked me to check it.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2021-12-24T00:00:00-08:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Mark Girard",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Mark Girard Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>


<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="http://localhost:4000/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="http://localhost:4000/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="http://localhost:4000/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="http://localhost:4000/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="http://localhost:4000/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="http://localhost:4000/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="http://localhost:4000/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="http://localhost:4000/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="http://localhost:4000/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="http://localhost:4000/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="http://localhost:4000/assets/css/academicons.css"/>


<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "none" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>





<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/">Mark Girard</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/teaching/">Teaching</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/projects/">Projects</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/year-archive/">Blog Posts</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/cv/">CV</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="http://localhost:4000/images/profile.jpg" class="author__avatar" alt="Mark Girard">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Mark Girard</h3>
    <p class="author__bio">PhD in Mathematics, Data Scientist, Mathematics Enthusiast</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> Waterloo, ON Canada</li>
      
      
      
      
        <li><a href="mailto:mark.w.girard@gmail.com"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i> Email</a></li>
      
      
       
        <li><a href="https://www.researchgate.net/profile/Mark-Girard"><i class="fab fa-fw fa-researchgate" aria-hidden="true"></i> ResearchGate</a></li>
      
      
      
      
      
        <li><a href="https://www.linkedin.com/in/markwgirard"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
      
      
      
      
      
      
        <li><a href="https://github.com/markwgirard"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="https://scholar.google.ca/citations?user=5gGfn_kAAAAJ&hl=en"><i class="fas fa-fw fa-graduation-cap"></i> Google Scholar</a></li>
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Confidence intervals: What they are (not)">
    <meta itemprop="description" content="Recently at my work, I was asked to assist in determining the correct formula for determining a confidence interval of an unknown quantity from a bunch of random samples. In particular, given random samples drawn from two different normal distributions, the task was to determine the confidence interval for the ratio of the means of those two distributions. My coworker (whose job it was to present this information) had found a formula somewhere online by googling, but wasn’t sure it was correct and asked me to check it.">
    <meta itemprop="datePublished" content="December 24, 2021">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Confidence intervals: What they are (not)
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  15 minute read
	
</p>
          
        
        
        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2021-12-24T00:00:00-08:00">December 24, 2021</time></p>
        
        
             
        
    
        </header>
      

      <section class="page__content" itemprop="text">
        <p>Recently at my work, I was asked to assist in determining the correct formula for determining a confidence interval of an unknown quantity from a bunch of random samples. In particular, given random samples drawn from two different normal distributions, the task was to determine the confidence interval for the <em>ratio of the means</em> of those two distributions. My coworker (whose job it was to present this information) had found a formula somewhere online by googling, but wasn’t sure it was correct and asked me to check it.</p>

<p>It is my job as the resident mathematician to help with these sorts of things. However, it has been well over a decade since I had done any meaningful amount of statistical analysis! I couldn’t make heads or tails of the formula he found. Not only that, I couldn’t even recall exactly what a confidence interval was!</p>

<h2 id="basic-notions">Basic notions</h2>

<p>The first thing I did was to google “confidence interval” and find a few primers on statistical analysis. On the most basic level, the concept of a <em>confidence interval</em> comes from the following.</p>

<p>Consider a collection of independently and identically distributed random variables $X_1,\dots,X_n$, each distributed according to a Gaussian distribution with some unknown mean $\mu$. After observing the values of some random samples for these variables, the task is to determine a real interval $[L,U]$ that represents a possible range of values for the true value of the mean $\mu$. The width of the interval should depend on the observed values but also on how <em>confidence</em> you want to be that this interval really does contain the true mean. This interval is the confidence interval.</p>

<h3 id="problems-with-the-basic-notions">Problems with the basic notions</h3>

<p>However, being the pure mathematician that I am, I wanted to delve deep and get a true understanding for what a confidence interval “means.” I was a bit concerned by the standard interpretation that rudimentary statistics books give. <a href="https://www.statology.org/confidence-intervals/">A post of Statology</a> gives an example where one wants to estimate the mean weight of a population of turtles given that the weights of a bunch of turtles are measured. After applying some formulas to the random samples, they state that the confidence interval has the following interpretation:</p>

<blockquote>
  <p>There is a 90% chance that the confidence interval of [293.91, 306.09] contains the true population mean weight of turtles.</p>
</blockquote>

<p>As a mathematician, I found this interpretation appalling! Two reasons:</p>

<ol>
  <li>
    <p>Firstly, it is implied that there a conditional probability of 90% that the mean $\mu$ lies in the interval [293.91, 306.09], conditioned on the event that we measured these specific values for the weights of a random sample of turtles. But this is a conditional probability that is conditioned on an event of probability zero! (The event that we measured <em>exactly</em> these weights occurs with  probability zero.) You can’t condition on events with zero probability. How should we interpret conditioning on an event of probability zero in this case?</p>
  </li>
  <li>
    <p>The true value of the mean $\mu$ is assumed to be some fixed (but unknown) value. Thus, given an interval $[L,U]$, either $\mu$ is in that interval or it is not. For example, if the true mean of the distribution is 300   then there is a 100% probability that the mean is contained in the interval [293.9,306.09]. But if the true mean were 310, then the interval in question has a 0% probability of containing the mean. What could possibly be meant by saying that “there is a 90% chance” that the interval contains the mean?</p>
  </li>
</ol>

<p>I concluded that this interpretation from Statology is surely <strong><em>not</em></strong> the correct interpretation of a confidence interval. So I started doing a deep dive…</p>

<h2 id="a-more-rigorous-definition-of-confidence-intervals">A more rigorous definition of confidence intervals</h2>

<p>I started looking at a few basic statistics textbooks, but the interpretations in those books either had the same pitfalls as the one described above, or were too complicated for me to understand. The best deep dive always begins with Wikipedia, which turned out to be surprisingly useful.</p>

<p>Based on the definition provided in Wikipedia, I devised my own definition of a confidence interval.</p>

<h3 id="statistical-model">Statistical model</h3>
<p>First, we need a concept of a family of distributions.  (A <em>probability distribution</em> is another term for a probability measure.)</p>
<blockquote>
  <p><strong>Definition.</strong> A <em>statistical model</em> for a measure space $(\mathcal{X},\mathcal{E})$ is a family \(\{P_\theta\,:\,\theta\in\Theta\}\) of probability distributions $P_\theta$ on $(\mathcal{X},\mathcal{E})$ for each $\theta$ in some index set $\Theta$.</p>
</blockquote>

<p>The most common example of a statistical model is the <em>normal family</em></p>

\[\{\mathcal{N}_{\mu,\sigma}\,:\,(\mu,\sigma)\in\mathbb{R}\times(0,\infty]\},\]

<p>which is the family of normal distributions on $\mathbb{R}$,  where for each choice of parameters $\theta$ and $\sigma$, the distribution is defined by
\(\mathcal{N}_{\theta,\sigma}(A) =\frac{1}{\sigma\sqrt{2\pi}}\int_A\exp\left(\frac{(x-\theta)^2}{2\sigma^2}\right)\,\mathrm{d}x\)
for every Borel subset $A\subset\mathbb{R}$.</p>

<h3 id="measurable-set-valued-functions">Measurable set-valued functions</h3>
<p>We next need a notion of measurable set-valued functions. For a set $\mathcal{Y}$, we let $\mathcal{P}(\mathcal{Y})$ denote the power set of $\mathcal{Y}$ (i.e., the set of all subsets).</p>
<blockquote>
  <p><strong>Definition.</strong> Let $(\mathcal{X},\mathcal{E})$ be a measurable space and let $\mathcal{Y}$ be a nonempty subset. A set-valued mapping $f:\mathcal{X}\to\mathcal{P}(\mathcal{Y})$ is said to be <em>$\mathcal{E}$-measurable</em> if, for each choice of $y\in\mathcal{Y}$, the set \(\{x\in\mathcal{X}\,:\, y\in f(x)\}\subset \mathcal{X}\) is $\mathcal{E}$-measurable.</p>
</blockquote>

<p>As an example, let $g_1:\mathcal{X}\to \mathbb{R}$ and $g_2:\mathcal{X}\to \mathbb{R}$ be Borel-measurable functions and define $f:\mathbb{R}\to\mathcal{P}(\mathbb{R})$ as \(f(x) = \{y\in\mathbb{R}:g_1(x)&lt;y&lt;g_2(x)\}\) for every $x\in\mathbb{R}$. (That is, for each choice of real number $x$, the set $f(x)$ is the open interval $(g_1(x),g_2(x))$). Because $g_1$ and $g_2$ are Borel-measureable, the sets \(g_1^{-1}\big((-\infty,y)\big) = \{x\in\mathcal{X}:g_1(x)&lt;y \}\) and \(g_2^{-1}\big((y,+\infty)\big) = \{x\in\mathcal{X}:y&lt;g_2(x) \}\) are measurable for each $y\in\mathbb{R}$, and thus so is the set \(g_1^{-1}\big((-\infty,y)\big)\cap g_2^{-1}\big((y,+\infty)\big)=\{x\in\mathcal{X}:y\in f(x)\}.\) If $X$ is an $(\mathcal{X},\mathcal{E})$-valued random variable, then $f(X)$ is a random interval. This is how one constructs confidence intervals for parameters of distributions.</p>

<h3 id="confidence-sets">Confidence sets</h3>
<p>We can now define a general concept of a confidence set for a statistical model. Let ${P_\theta\,:\,\theta\in\Theta}$ be a statistical model for a measure space $(\mathcal{X},\mathcal{E})$. A mapping $g:\Theta\to\mathcal{Y}$ from the parameter set $\Theta$ to some non-empty set $\mathcal{Y}$ is an <em>estimand</em> for the parameter space. Namely, we are typically only interested in estimating certain properties of the parameter $\theta\in\Theta$ rather than the entire value of the parameter itself.</p>
<blockquote>
  <p><strong>Definition.</strong> Let $g:\Theta\to\mathcal{Y}$ be an estimand of a statistical model ${P_\theta\,:\,\theta\in\Theta}$ for some measure space $(\mathcal{X},\mathcal{E})$. For a real value $\alpha\in[0,1]$, an  <em>$\alpha$-level confidence set</em> for the estimand $g$ is a $\mathcal{E}$-measurable set-valued mapping $f:\mathcal{X}\to\mathcal{P}(\mathcal{Y})$ such that \(P_\theta\big(\{x\in\mathcal{X}\,:\, g(\theta)\in f(x)\}\big) \geq 1-\alpha\) holds for every choice of parameter $\theta\in\Theta$.</p>
</blockquote>

<p>Because $f$ is $\mathcal{E}$-measurable, the sets ${x\in\mathcal{X}\,:\, y\in f(x)}$ are $\mathcal{E}$-measurable for each $\theta\in\Theta$ and thus these sets can be assigned a probability for each probability measure $P_\theta$.</p>

<p>Note that $P_\theta\big({x\in\mathcal{X}\,:\, g(\theta)\in f(x)}\big)$ represents the probability that the estimand $g(\theta)$ is contained within the estimating set $f(x)$. If $X$ is $(\mathcal{X},\mathcal{E})$-valued random variable then $f(X)$ is a random set and \(\Pr(g(\theta)\in f(X))=P_\theta\big(\{x\in\mathcal{X}\,:\, g(\theta)\in f(x)\}\big),\) supposing that $X$ is distributed according to $P_\theta$.</p>

<p>Typically onw desires an $\alpha$-level confidence set such that the probabilities are <em>equal</em> to $1-\alpha$ for every $\theta\in\Theta$. This is ho we will construct confidence intervals later on.</p>

<h3 id="confidence-intervals">Confidence intervals</h3>
<p>Let ${P_\theta\,:\,\theta\in\Theta}$ be a statistical model for some measurable space $(\mathcal{X},\mathcal{E})$ and let $g:\Theta\to\mathbb{R}$ be an estimand for the parameter space. Confidence sets for such real-valued estimands typically take the form of intervals (as shown above). A <em>confidence interval</em> $f:\mathcal{X}\to\mathcal{P}(\mathbb{R})$ for this estimand can be constructed by taking two Borel-measurable functions $g_1:\mathcal{X}\to \mathbb{R}$ and $g_2:\mathcal{X}\to \mathbb{R}$ satisfying $g_1(x)&lt;g_2(x)$ for each $x\in\mathcal{X}$ and defining $f(x)$ to be the interval $(g_1(x),g_2(x))$ for each $x\in\mathcal{X}$.</p>

<h3 id="interpretation-of-confidence-sets">Interpretation of confidence sets</h3>
<p>Let us now consider the proper interpretation of a confidence set. Let ${P_\theta:\theta\in\Theta}$ be a statistical model of candidate probability distributions for some $(\mathcal{X},\mathcal{E})$-valued random variable $X$. That is, the true probability distribution of $X$ is given by $P_{\theta_0}$ for some unknown (but fixed) choice of parameter $\theta_0\in\Theta$. Let $g:\Theta\to\mathcal{Y}$ be an estimand such that we wish to estimate the true value of $g(\theta_0)$. For a choice of confidence level $\alpha\in[0,1]$, we choose a confidence set $f:\mathcal{X}\to\mathcal{P}(\mathcal{Y})$ such that $f(X)$ is a random set.</p>

<p>Perform now the following experiment. Randomly choose a value of $x\in\mathcal{X}$ according to the distribution $P_{\theta_0}$, and from this randomly chosen value construct the corresponding set $f(x)\subset\mathcal{Y}$. By construction, the probability that this experiment will produce a set containing $g(\theta_0)$ is at least $1-\alpha$. That is, if this experiment were performed repeatedly, the proportion of times that the constructed set will contain $g(\theta_0)$ is at least $1-\alpha$. This is the proper interpretation of a confidence set!</p>

<p>Note that, after performing the experiment, we obtain a single value of $x$ for $X$. Either the set $f(x)$ contains $g(\theta_0)$ or it does not. Recall the <strong><em>wrong</em></strong> interpretation of confidence sets that was mentioned at the start of this blog post. It is <strong><em>not</em></strong> correct to say that $f(x)$ contains $g(\theta_0)$ with probability $1-\alpha$. Indeed, the post-facto “probability” that the constructed $f(x)$ contains $g(\theta_0)$ at the end of the experiment is either 1 ot 0 (depending on whether the true value is contained in the set or not).</p>

<p>It is better to say that “the probability that this procedure constructed a set containing the true value of the estimand is at least $1-\alpha$.”</p>

<h2 id="confidence-intervals-for-normally-distributed-random-samples">Confidence intervals for normally distributed random samples</h2>

<p>We now go through the standard process of constructing confidence intervals for the mean of a normal distributed random variable from a random sample of independent and identical normally distributed random variables.</p>

<p>For the family of normal distributions${\mathcal{N}_{\mu,\sigma}:(\mu,\sigma)\in\mathbb{R}\times(0,\infty)}$ with parameter space $\Theta = \mathbb{R}\times(0,\infty)$, suppose we wish to estimate the mean. Our estimand is the real-valued function $g:\mathbb{R}\times(0,\infty)\to\mathbb{R}$ defined as $g(\mu,\sigma)=\mu$.</p>

<p>Let $X=(X_1,X_2,\dots,X_n)$ for some i.i.d. normally distributed random variables $X_1,X_2,\dots,X_n$, each distributed according to $\mathcal{N}_{\mu_0,\sigma_0}$ for some fixed (but unknown) mean $\mu_0$ and varialce $\sigma_0{}^2$. We wish to construct a confidence interval for $\mu_0$. Define the random variables \(\overline{X}=\frac{1}{n}\sum_{i=1}^nX_i\) and \(S = \sqrt{\frac{\sum_{i-1}^n(\overline{X}-X_i)^2}{n-1}},\)
which are the <em>sample mean</em> and <em>sample standard devition</em>, respectively. Note that the expected values of these random variables are $\operatorname{E}(\overline{X})=\mu_0$ and $\operatorname{E}(S)=\sigma$. Moreover, it holds that $\overline{X}$ is normally distributed with mean $\mu_0$ and variance $\sigma_0/\sqrt{n}$, while $S$ is distributed according to the $\chi$-distribution with $n-1$ degrees of freedom. Define a further random variable \(T=\frac{\overline{X}-\mu_0}{S/\sqrt{n}},\) which is distributed according to Student’s $t$-distribution with $n-1$ degrees of freedom. That is, for every Borel subset $A\subset\mathbb{R}$, one has that \(\Pr(T\in A) = \int_A f_{n-1}(x)\,\mathrm{d}x\) where for each $k\in\mathbb{N}$, the probability density function $f_k:\mathbb{R}\to\mathbb{R}$ for Student’s $t$-distribution is defined by \(f_k(x) = \frac{\Gamma(\frac{k+1}{2})}{\sqrt{k\pi}\Gamma(\frac{k}{2})}\left(1+\frac{x^2}{k}\right)^{-\frac{k+1}{2}}\) for each $x\in\mathbb{R}$. Note that the corresponding cumulative density function $F_k:\mathbb{R}\to(0,1)$ defined by \(F_k(x)=\int_{-\infty}^x f_k(t)\,\mathrm{d}t\) for each $x\in\mathbb{R}$ is strictly increasing and is therefore invertible on the interval $(0,1)$.</p>

<p>For each $k\in\mathbb{N}$ and $\gamma\in\mathbb{R}$, define $\tau_{k,\gamma}=F_{k}^{-1}(\gamma)$ such that
\(\begin{split}\Pr\left(\overline{X}-\frac{\tau_{n-1,\gamma}S}{\sqrt{n}}&lt; \mu_0\right) &amp; = \Pr\left(\frac{\overline{X}-\mu_0}{S/\sqrt{n}}\leq \tau_{n-1,\gamma}\right)\\ &amp; = \Pr\left(T\leq \tau_{n-1,\gamma}\right)\\&amp;= F_{n-1}(\tau_{n-1,\gamma})\\&amp;=\gamma.\end{split}\) Similarly, note that \(\begin{split}\Pr\left(\overline{X}-\frac{\tau_{n-1,\gamma}S}{\sqrt{n}}&gt; \mu_0\right) &amp; = 1- \Pr\left(T\leq\tau_{n-1,\gamma}\right)\\ &amp; = 1-\gamma.\end{split}\)</p>

<p>We may now define the confidence intervals. Let $\alpha\in(0,1)$ be a desired confidence level and define real-valued functions $g_1:\mathbb{R}^n\to\mathbb{R}$ and $g_2:\mathbb{R}^n\to\mathbb{R}$ as \(g_1(X) = \overline{X} - \frac{\tau_{n-1,\alpha/2}S}{\sqrt{n}}\qquad\text{and}\qquad g_1(X) = \overline{X} - \frac{\tau_{n-1,1-\frac{\alpha}{2}}S}{\sqrt{n}},\) each of which is clearly Borel. Then $(g_1(X),g_2(X))$ is the desired random interval, as \(\begin{split}\Pr\big(g_1(X)&lt; \mu_0 &lt;g_2(X)\big) &amp;= \Pr\big( \mu_0 &lt;g_2(X)\big) - \Pr\big(g_1(X)\geq\mu_0 \big)\\ &amp; =1-\frac{\alpha}{2} - \frac{\alpha}{2}\\ &amp; = 1-\alpha.\end{split}\)</p>

<h2 id="confidence-intervals-for-ratio-of-means">Confidence intervals for ratio of means</h2>
<p>We now arrive at the confidence interval that I was asked to derive for my work.</p>

<p>Suppose $X_{0,1},X_{0,2},\dots,X_{0,n_0}$ and $X_{1,1},X_{1,2},\dots,X_{1,n_1}$ are independent random variables such that $X_{0,i}$ is normally distributed with mean $\mu_0$ and variance $\sigma_0{}^2$ for each $i\in{1,\dots,n_0}$ and $X_{1,j}$ is normally distributed with mean $\mu_1$ and variance $\sigma_1{}^2$ for each $j\in{1,\dots,n_1}$. The estimand that we wish to estimate in this case is the ratio of the means $\rho=\frac{\mu_0}{\mu_1}$.</p>

<p>As before, define the sample mean random variables \(\overline{X}_0 = \frac{1}{n_0}\sum_{i=1}^{n_0}X_{1,i}\qquad \text{and}\qquad \overline{X}_1=\frac{1}{n_1}\sum_{j=1}^{n_1}\) and sample standard deviation random variables \(S_0 = \sqrt{\frac{\sum_{i-1}^n(\overline{X}_0-X_{0,j})^2}{n_0-1}}\qquad\text{and}\qquad S_1 = \sqrt{\frac{\sum_{j=1}^{n_1}(\overline{X}_1-X_{1,j})^2}{n_1-1}}.\) Define further the $t$-statistic random variables as \(T_0=\frac{\overline{X}_0-\mu_0}{S_0/\sqrt{n_0}}\qquad\text{and}\qquad T_1=\frac{\overline{X}_1-\mu_1}{S_1/\sqrt{n_1}},\) which are independent and each distributed according the Student’s $t$-distribution with $n_0-1$ and $n_1-1$ degrees of freedom, respectively.</p>

<p>Define now a real-valued function $h$ as \(\begin{split}h(\gamma,x_0,s_0,x_1,s_1)
&amp;= \int_{-\infty}^\frac{x_1}{s_1/\sqrt{n_1}}\left(1-F_{n_0-1}\left(\frac{x_0-\gamma(x_1-s_1t/\sqrt{n_1})}{s_0/\sqrt{n_0}}\right)\right)f_{n-1}(t)\mathrm{d}t\\
 &amp; \qquad + \int_{\frac{x_1}{s_1/\sqrt{n_1}}}^\infty F_{n_0-1}\left(\frac{x_0-\gamma(x_1-s_1t/\sqrt{n_1})}{s_0/\sqrt{n_0}}\right)f_{n_1-1}(t)\mathrm{d}t
\end{split}\) for each $\gamma,x_0,x_1,s_0,s_1\in\mathbb{R}$ where $s_0$ and $s_1$ are positive. For fixed choices of values for $x_0$, $x_1$, $s_0$, and $s_1$, this function is strictly increasing in $\gamma$ and satisfies \(\lim_{\gamma\to-\infty}h(\gamma,x_0,s_0,x_1,s_1)=0\qquad\text{and}\qquad \lim_{\gamma\to+\infty}h(\gamma,x_0,s_0,x_1,s_1)=0.\) One may therefore define a real-valued function $g$ as follows. For each $\alpha\in(0,1)$ and every choice of values $\gamma,x_0,x_1,s_0,s_1\in\mathbb{R}$ such that $s_0$ and $s_1$ are positive, the value of \(g(\alpha,x_0,s_0,x_1,s_1)\) is equal to the unique value $\gamma\in\mathbb{R}$ such that <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> $h(\gamma,x_0,s_0,x_1,s_1)=\alpha$, and define the random variable $C_\alpha$ as \(C_\alpha = g(\alpha,\overline{X}_0,S_0,\overline{X}_1,S_1).\) By construction, it holds that
\(h(C_\alpha,\overline{X}_0,S_0,\overline{X}_1,S_1) = \alpha\)
and thus \(\Pr\left(\frac{\mu_0}{\mu_1}\leq C_\alpha\right) = \operatorname{E}\left(h(C_\alpha,\overline{X}_0,S_0,\overline{X}_1,S_1)\right) = \alpha.\) Now, for each $\alpha\in(0,1)$, one has that
\(\begin{split}\Pr\left(C_{\frac{\alpha}{2}}&lt;\frac{\mu_0}{\mu_1}&lt;C_{1-\frac{\alpha}{2}}\right) &amp;= \Pr\left(\frac{\mu_0}{\mu_1}&lt;C_{1-\frac{\alpha}{2}}\right) - \Pr\left(\frac{\mu_0}{\mu_1}&lt;C_{\frac{\alpha}{2}}\right) \\ &amp;=1-\frac{\alpha}{2} - \frac{\alpha}{2}\\&amp;=1-\alpha.\end{split}\) That is, for a given $\alpha\in(0,1)$, we have a confidence interval $(C_{\frac{\alpha}{2}},C_{1-\frac{\alpha}{2}})$ for $\frac{\mu_0}{\mu_1}$ with confidence level $\alpha$.</p>

<h3 id="code-for-constructing-confidence-intervals">Code for constructing confidence intervals</h3>
<p>Here is some code for implementing this process to compute the confidence intervals from sample data.</p>

<p>You can find the code in my colab notebook (with an application of it applied to a randomly generated set of sample data) <a href="https://colab.research.google.com/drive/1uOa9Y523DDzFaHOMUSlogVeyukF7AVTS?usp=sharing">here</a>.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">statistics</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">"ignore"</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="nb">RuntimeWarning</span><span class="p">)</span>
<span class="c1"># Compute confidence interval for ratio of means
</span>
<span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ny</span><span class="p">):</span>
  <span class="c1"># t_ is the variable of integration
</span>  <span class="c1"># The other terms (rho, mx, sx, nx, my, sy, ny) are the parameter arguments
</span>  <span class="c1">#  - nx and ny are the number of samples of X and Y
</span>  <span class="c1">#  - mx and my are the sample meams (i.e., x = (X1+X2+...+Xn)/n)
</span>  <span class="c1">#  - sx and sy are the unbiased sample standard deviations
</span>  <span class="c1">#     (i.e., sx = 1/(n-1) * [sum of (Xi - x)^2]
</span>  <span class="c1">#  - rho is the estimate for the ratio of the true means of X and Y
</span>  <span class="c1">#     (i.e., rho = E(X)/E(Y))
</span>  <span class="n">A</span> <span class="o">=</span> <span class="n">mx</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">my</span> <span class="o">-</span> <span class="n">t_</span> <span class="o">*</span> <span class="n">sy</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
  <span class="n">B</span> <span class="o">=</span> <span class="n">sx</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>

  <span class="n">il</span> <span class="o">=</span> <span class="n">A</span><span class="o">/</span><span class="n">B</span>                  <span class="c1"># inner limit of integration
</span>  <span class="n">ol</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ny</span><span class="p">)</span> <span class="o">*</span> <span class="n">my</span> <span class="o">/</span> <span class="n">sy</span> <span class="c1"># outer limit of integration
</span>
  <span class="k">if</span> <span class="n">t_</span> <span class="o">&lt;=</span> <span class="n">ol</span><span class="p">:</span>
    <span class="n">inner_prob</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">il</span><span class="p">,</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">t_</span> <span class="o">&gt;</span> <span class="n">ol</span><span class="p">:</span>
    <span class="n">inner_prob</span> <span class="o">=</span> <span class="n">scipy</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">il</span><span class="p">,</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">inner_prob</span> <span class="o">*</span> <span class="n">scipy</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span><span class="n">ny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pvalue</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ny</span><span class="p">):</span>
  <span class="c1"># Returns the probability that the true mean is less than rho
</span>  <span class="k">return</span> <span class="n">scipy</span><span class="p">.</span><span class="n">integrate</span><span class="p">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ny</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">pvalue_offset</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">pvalue</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span> <span class="o">-</span> <span class="n">gamma</span>

<span class="k">def</span> <span class="nf">get_confidence_interval</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ny</span><span class="p">):</span>
  <span class="c1"># alpha is the confidence level (i.e., should be .9 or .95)
</span>  <span class="n">confint</span> <span class="o">=</span> <span class="p">[</span><span class="n">scipy</span><span class="p">.</span><span class="n">optimize</span><span class="p">.</span><span class="n">root</span><span class="p">(</span><span class="n">pvalue_offset</span><span class="p">,</span> <span class="n">mx</span><span class="o">/</span><span class="n">my</span><span class="p">,</span> \
                                 <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>\
                                 <span class="p">).</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">]]</span>
  <span class="k">return</span> <span class="n">confint</span>
</code></pre></div></div>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>That is, it holds that $h(g(\alpha,x_0,s_0,x_1,s_1),x_0,s_0,x_1,s_1) = \alpha.$ <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/tags/#mathematics" class="page__taxonomy-item" rel="tag">mathematics</a>
    
    </span>
  </p>




      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/posts/2021/12/Confidence-intervals/" class="btn btn--twitter" title="Share on Twitter"><i class="fab fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/posts/2021/12/Confidence-intervals/" class="btn btn--facebook" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/posts/2021/12/Confidence-intervals/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fab fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="http://localhost:4000/posts/2021/03/first-post/" class="pagination--pager" title="First post
">Previous</a>
    
    
      <a href="http://localhost:4000/posts/2022/09/riddler-overlapping-disks/" class="pagination--pager" title="Covering a square of overlapping disks (Riddler 2022-09-09)
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      
        <h4 class="page__related-title">You May Also Enjoy</h4>
      
      <div class="grid__wrapper">
        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/posts/2022/10/riddler-mexican-lottery/" rel="permalink">What are the odds of a solo win in Mexican lottery? (Riddler 2022-10-21)
</a>
      
    </h2>
    
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  4 minute read
	
</p>
    

        
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2022-10-23T00:00:00-07:00">October 23, 2022</time></p>
        

    
    <p class="archive__item-excerpt" itemprop="description"><script type="text/javascript" async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</p>
    
    
    

  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/posts/2022/10/riddler-birthday-party/" rel="permalink">How big is your birthday surprise party? (Riddler 2022-10-14)
</a>
      
    </h2>
    
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  4 minute read
	
</p>
    

        
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2022-10-14T00:00:00-07:00">October 14, 2022</time></p>
        

    
    <p class="archive__item-excerpt" itemprop="description"><script type="text/javascript" async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</p>
    
    
    

  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/posts/2022/09/riddler-anigrams/" rel="permalink">Can You Build The Biggest ‘Anigram’? (Riddler 2022-09-16)
</a>
      
    </h2>
    
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  4 minute read
	
</p>
    

        
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2022-09-19T00:00:00-07:00">September 19, 2022</time></p>
        

    
    <p class="archive__item-excerpt" itemprop="description"><script type="text/javascript" async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</p>
    
    
    

  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/posts/2022/09/riddler-overlapping-disks/" rel="permalink">Covering a square of overlapping disks (Riddler 2022-09-09)
</a>
      
    </h2>
    
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  3 minute read
	
</p>
    

        
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2022-09-11T00:00:00-07:00">September 11, 2022</time></p>
        

    
    <p class="archive__item-excerpt" itemprop="description"><script type="text/javascript" async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</p>
    
    
    

  </article>
</div>

        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/markwgirard"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Mark Girard. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  </body>
</html>

