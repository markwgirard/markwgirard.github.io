{"title":"Riddler: How big is your birthday surprise party?","markdown":{"yaml":{"title":"Riddler: How big is your birthday surprise party?","date":"2022-10-14","description":"Modeling birthday collisions in a unique gift-sharing game.","author":"Mark Girard","categories":["programming","riddler","probability"],"format":"html"},"headingText":"The Problem","containsRefs":false,"markdown":"\n\n\nMy solution to [this week's riddler](https://fivethirtyeight.com/features/can-you-salvage-your-rug/). (See more of [my Riddler solutions here](/riddlers).)\n\n> Today I happen to be celebrating the birthday of a family member, which got me wondering about how likely it is for two people in a room to have the same birthday.\n>\n> Suppose people walk into a room, one at a time. Their birthdays happen to be randomly distributed throughout the 365 days of the year (and no one was born on a leap day). The moment two people in the room have the same birthday, no more people enter the room and everyone inside celebrates by eating cake, regardless of whether that common birthday happens to be today.\n>\n> On average, what is the expected number of people in the room when they eat cake?\n>\n> __Extra credit__: Suppose everyone eats cake the moment three people in the room have the same birthday. On average, what is this expected number of people?\n\n## The Solution\n\nFor each pair of non-negative integers $n$ and $k$, let $p_{n,k}$ denote the probability that no $k$ people share a birthday when there are $n$ guests present. Also define $E_k$ as the expected number of guests that must arrive for there to be $k$ people that share a birthday. The first observation that we will make is that\n\n$$\nE_k  = \\sum_{n=0}^\\infty p_{n,k}.\n$$\n\nIndeed, if we define random variables $X_{n,k}$ as\n\n$$\nX_{n,k} = \\left\\{\\begin{array}{ll}\n0, & \\text{if at least }k \\text{ guests share a birthday after }n\\text{ guests have arrived}\\\\\n1, &\\text{otherwise},\n\\end{array}\\right.\n$$\n\nthen the total number of guests that have arrived at the first time there is a $k$-fold shared birthday is the random variable\n\n$$\nX_k = X_{0,k} + X_{1,k} + \\cdots +  X_{365(k-1),k}.\n$$\n\nThe expected value of this random variable is\n\n$$\n\\begin{align*}\nE_k = \\operatorname{E}(X_k)\n&= \\sum_{n=0}^{365(k-1)} \\operatorname{E}(X_{n,k})\\\\\n&=\\sum_{n=0}^\\infty p_{n,k}\n\\end{align*}\n$$\n\nwhere we note that $p_{n,k}=0$ whenever $n>365(k-1)$ (because, by the pigeonhole principle, there must otherwise be at least one day on which at least $k$ guests share a birthday). Also note that $p_{0,k}=1$ for every $k\\geq1$ (as there can be no shared birthdays if no guests are present).\n\nNow, the number of distinct ways in which $n$ guests can arrive such that there is no day on which at least $k$ of them share a birthday is equal to the number of ordered sequences $$(a_1,a_2,\\dots,a_n)$$ of numbers $$a_1,\\dots,a_n\\in\\{1,\\dots,365\\}$$ such that no number appears more than $k-1$ times. The number of such sequences is equal to\n\n$$\n\\sum_{\\substack{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}\\\\k_1+k_2+\\cdots+k_{365}= n}}\n\\binom{n}{k_1,k_2,\\dots,k_{365}}\n$$\n\nwhere\n\n$$\n\\binom{n}{k_1,k_2,\\dots,k_{365}} = \\frac{n!}{k_1!k_2!\\cdots k_{365}!}\n$$\n\nis the [multinomial coefficient](https://en.wikipedia.org/wiki/Multinomial_theorem). Because there are $365^n$ ways in which $n$ guests can arrive in order, the probability that no $k$ guests share a birthday after $n$ guests have arrived is  \n\n$$\n\\begin{align*}\np_{n,k} &= \\frac{n!}{365^n}\\sum_{\\substack{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}\\\\k_1+k_2+\\cdots+k_{365}= n}} \\frac{1}{k_1!k_2!\\cdots k_{365}!}\n\\\\\n&= \\sum_{\\substack{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}\\\\k_1+k_2+\\cdots+k_{365}= n}} \\frac{1}{365^{k_1+k_2+\\cdots +k_{365}}}\\frac{(k_1+k_2\\cdots k_{365})!}{k_1!k_2!\\cdots k_{365}!}.\n\\end{align*}\n$$\n\nWe now may express the desired expected values as\n\n$$\n\\begin{align*}\nE_k\n&= \\sum_{n=0}^\\infty \\sum_{\\substack{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}\\\\k_1+k_2+\\cdots+k_{365}= n}} \\frac{1}{365^{k_1+k_2+\\cdots +k_{365}}}\\frac{(k_1+k_2\\cdots k_{365})!}{k_1!k_2!\\cdots k_{365}!}\\\\\n & = \\sum_{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}}\n \\frac{1}{365^{k_1+k_2+\\cdots +k_{365}}}\\frac{(k_1+k_2\\cdots k_{365})!}{k_1!k_2!\\cdots k_{365}!}.\n\\end{align*}\n$$\n\nMaking use of the fact that\n\n$$\nn! = \\int_{0}^\\infty t^n e^{-t}\\, \\mathrm{d}t\n$$\n\nholds for every non-negative integer $n$, we may compute the expected values as\n\n$$\n\\begin{align*}\nE_k &\n = \\sum_{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}} \\frac{1}{365^{k_1+k_2+\\cdots k_{365}}}\\frac{1}{k_1!k_2!\\cdots k_{365}!} \\int_{0}^\\infty t^{k_1+k_2+\\cdots+k_{365}} e^{-t}\\, \\mathrm{d}t\\\\\n & = \\int_{0}^\\infty \\sum_{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}}\n \\left(\n   \\frac{\\left(\\frac{t}{365}\\right)^{k_1}}{k_1!} \\cdots \\frac{\\left(\\frac{t}{365}\\right)^{k_{365}}}{k_{365}!}\n   \\right)\n   e^{-t}\\, \\mathrm{d}t\\\\\n & = \\int_{0}^\\infty\n \\left(\n   \\sum_{n=0}^{k-1} \\frac{\\left(\\frac{t}{365}\\right)^{n}} {n!}\n   \\right)^{365}\n   e^{-t}\\, \\mathrm{d}t\\\\\n& = 365\\int_{0}^\\infty \\left(e^{-t}\\sum_{n=0}^{k-1}\\frac{t^n}{n!}\\right)^{365}\\, \\mathrm{d}t,\n\\end{align*}\n$$\n\nwhere the last line follows after making a change of variables in the integration.\n\nUsing this formula, we can now compute the expected numbers of guests that have arrived at the first instance when $k$ people share a birthday for different values of $k$, the first few values are shown in the table below.\n\n```python\nfrom scipy.integrate import quad\nfrom scipy.special import factorial\n\ndef E(k, m=365):\n\n    def integrand(t):\n        out = (sum(np.exp(n*math.log(t) - t) / factorial(n) for n in range(k))) ** m\n        return out\n\n    return quad(integrand, 0, np.inf)\n```\n\n\n| $k$ | $E_k$|\n|--|-------|\n|1|1.0|\n|2|24.6166|\n|3|88.7389|\n|4|187.0518|\n|5|311.4494|\n|6|456.0163|\n|7|616.6169|\n|8|790.2997|\n|9|974.8939|\n|10|1168.7567|\n|11|1370.6135|\n|12|1579.4531|\n|13|1794.459|\n|14|2014.9607|\n|15|2240.3999|\n|16|2470.3065|\n|17|2704.2798|\n|18|2941.9755|\n|19|3183.095|\n|20|3427.3773|\n|21|3674.5931|\n|22|3924.5391|\n|23|4177.0347|\n|24|4431.918|\n|25|4689.0437|\n\nBelow are some plots of these values.\n\n![Expected size of party the first time when there are k people who share a birthday.](/blog/images/riddler-birthday-surprise_1.png)\n\n\n![Growth of expected party size as k increases appears to be linear, and approaches $365k$ in the limit of large $k$.](/blog/images/riddler-birthday-surprise_2.png)\n\nIt seems that, in the limit of large $k$, the ratio of the expected party size to the maximum party size of $\\sim365k$ approaches 1.","srcMarkdownNoYaml":"\n\n\nMy solution to [this week's riddler](https://fivethirtyeight.com/features/can-you-salvage-your-rug/). (See more of [my Riddler solutions here](/riddlers).)\n\n## The Problem\n> Today I happen to be celebrating the birthday of a family member, which got me wondering about how likely it is for two people in a room to have the same birthday.\n>\n> Suppose people walk into a room, one at a time. Their birthdays happen to be randomly distributed throughout the 365 days of the year (and no one was born on a leap day). The moment two people in the room have the same birthday, no more people enter the room and everyone inside celebrates by eating cake, regardless of whether that common birthday happens to be today.\n>\n> On average, what is the expected number of people in the room when they eat cake?\n>\n> __Extra credit__: Suppose everyone eats cake the moment three people in the room have the same birthday. On average, what is this expected number of people?\n\n## The Solution\n\nFor each pair of non-negative integers $n$ and $k$, let $p_{n,k}$ denote the probability that no $k$ people share a birthday when there are $n$ guests present. Also define $E_k$ as the expected number of guests that must arrive for there to be $k$ people that share a birthday. The first observation that we will make is that\n\n$$\nE_k  = \\sum_{n=0}^\\infty p_{n,k}.\n$$\n\nIndeed, if we define random variables $X_{n,k}$ as\n\n$$\nX_{n,k} = \\left\\{\\begin{array}{ll}\n0, & \\text{if at least }k \\text{ guests share a birthday after }n\\text{ guests have arrived}\\\\\n1, &\\text{otherwise},\n\\end{array}\\right.\n$$\n\nthen the total number of guests that have arrived at the first time there is a $k$-fold shared birthday is the random variable\n\n$$\nX_k = X_{0,k} + X_{1,k} + \\cdots +  X_{365(k-1),k}.\n$$\n\nThe expected value of this random variable is\n\n$$\n\\begin{align*}\nE_k = \\operatorname{E}(X_k)\n&= \\sum_{n=0}^{365(k-1)} \\operatorname{E}(X_{n,k})\\\\\n&=\\sum_{n=0}^\\infty p_{n,k}\n\\end{align*}\n$$\n\nwhere we note that $p_{n,k}=0$ whenever $n>365(k-1)$ (because, by the pigeonhole principle, there must otherwise be at least one day on which at least $k$ guests share a birthday). Also note that $p_{0,k}=1$ for every $k\\geq1$ (as there can be no shared birthdays if no guests are present).\n\nNow, the number of distinct ways in which $n$ guests can arrive such that there is no day on which at least $k$ of them share a birthday is equal to the number of ordered sequences $$(a_1,a_2,\\dots,a_n)$$ of numbers $$a_1,\\dots,a_n\\in\\{1,\\dots,365\\}$$ such that no number appears more than $k-1$ times. The number of such sequences is equal to\n\n$$\n\\sum_{\\substack{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}\\\\k_1+k_2+\\cdots+k_{365}= n}}\n\\binom{n}{k_1,k_2,\\dots,k_{365}}\n$$\n\nwhere\n\n$$\n\\binom{n}{k_1,k_2,\\dots,k_{365}} = \\frac{n!}{k_1!k_2!\\cdots k_{365}!}\n$$\n\nis the [multinomial coefficient](https://en.wikipedia.org/wiki/Multinomial_theorem). Because there are $365^n$ ways in which $n$ guests can arrive in order, the probability that no $k$ guests share a birthday after $n$ guests have arrived is  \n\n$$\n\\begin{align*}\np_{n,k} &= \\frac{n!}{365^n}\\sum_{\\substack{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}\\\\k_1+k_2+\\cdots+k_{365}= n}} \\frac{1}{k_1!k_2!\\cdots k_{365}!}\n\\\\\n&= \\sum_{\\substack{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}\\\\k_1+k_2+\\cdots+k_{365}= n}} \\frac{1}{365^{k_1+k_2+\\cdots +k_{365}}}\\frac{(k_1+k_2\\cdots k_{365})!}{k_1!k_2!\\cdots k_{365}!}.\n\\end{align*}\n$$\n\nWe now may express the desired expected values as\n\n$$\n\\begin{align*}\nE_k\n&= \\sum_{n=0}^\\infty \\sum_{\\substack{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}\\\\k_1+k_2+\\cdots+k_{365}= n}} \\frac{1}{365^{k_1+k_2+\\cdots +k_{365}}}\\frac{(k_1+k_2\\cdots k_{365})!}{k_1!k_2!\\cdots k_{365}!}\\\\\n & = \\sum_{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}}\n \\frac{1}{365^{k_1+k_2+\\cdots +k_{365}}}\\frac{(k_1+k_2\\cdots k_{365})!}{k_1!k_2!\\cdots k_{365}!}.\n\\end{align*}\n$$\n\nMaking use of the fact that\n\n$$\nn! = \\int_{0}^\\infty t^n e^{-t}\\, \\mathrm{d}t\n$$\n\nholds for every non-negative integer $n$, we may compute the expected values as\n\n$$\n\\begin{align*}\nE_k &\n = \\sum_{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}} \\frac{1}{365^{k_1+k_2+\\cdots k_{365}}}\\frac{1}{k_1!k_2!\\cdots k_{365}!} \\int_{0}^\\infty t^{k_1+k_2+\\cdots+k_{365}} e^{-t}\\, \\mathrm{d}t\\\\\n & = \\int_{0}^\\infty \\sum_{k_1,\\dots,k_{365}\\in\\{0,1,\\dots,k-1\\}}\n \\left(\n   \\frac{\\left(\\frac{t}{365}\\right)^{k_1}}{k_1!} \\cdots \\frac{\\left(\\frac{t}{365}\\right)^{k_{365}}}{k_{365}!}\n   \\right)\n   e^{-t}\\, \\mathrm{d}t\\\\\n & = \\int_{0}^\\infty\n \\left(\n   \\sum_{n=0}^{k-1} \\frac{\\left(\\frac{t}{365}\\right)^{n}} {n!}\n   \\right)^{365}\n   e^{-t}\\, \\mathrm{d}t\\\\\n& = 365\\int_{0}^\\infty \\left(e^{-t}\\sum_{n=0}^{k-1}\\frac{t^n}{n!}\\right)^{365}\\, \\mathrm{d}t,\n\\end{align*}\n$$\n\nwhere the last line follows after making a change of variables in the integration.\n\nUsing this formula, we can now compute the expected numbers of guests that have arrived at the first instance when $k$ people share a birthday for different values of $k$, the first few values are shown in the table below.\n\n```python\nfrom scipy.integrate import quad\nfrom scipy.special import factorial\n\ndef E(k, m=365):\n\n    def integrand(t):\n        out = (sum(np.exp(n*math.log(t) - t) / factorial(n) for n in range(k))) ** m\n        return out\n\n    return quad(integrand, 0, np.inf)\n```\n\n\n| $k$ | $E_k$|\n|--|-------|\n|1|1.0|\n|2|24.6166|\n|3|88.7389|\n|4|187.0518|\n|5|311.4494|\n|6|456.0163|\n|7|616.6169|\n|8|790.2997|\n|9|974.8939|\n|10|1168.7567|\n|11|1370.6135|\n|12|1579.4531|\n|13|1794.459|\n|14|2014.9607|\n|15|2240.3999|\n|16|2470.3065|\n|17|2704.2798|\n|18|2941.9755|\n|19|3183.095|\n|20|3427.3773|\n|21|3674.5931|\n|22|3924.5391|\n|23|4177.0347|\n|24|4431.918|\n|25|4689.0437|\n\nBelow are some plots of these values.\n\n![Expected size of party the first time when there are k people who share a birthday.](/blog/images/riddler-birthday-surprise_1.png)\n\n\n![Growth of expected party size as k increases appears to be linear, and approaches $365k$ in the limit of large $k$.](/blog/images/riddler-birthday-surprise_2.png)\n\nIt seems that, in the limit of large $k$, the ratio of the expected party size to the maximum party size of $\\sim365k$ approaches 1."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"css":["../../styles.css"],"output-file":"2022-10-14-birthday-party.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","theme":"flatly","title":"Riddler: How big is your birthday surprise party?","date":"2022-10-14","description":"Modeling birthday collisions in a unique gift-sharing game.","author":"Mark Girard","categories":["programming","riddler","probability"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}